running pytest
Searching for pytest
Best match: pytest 3.7.1
Processing pytest-3.7.1-py2.7.egg

Using /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/.eggs/pytest-3.7.1-py2.7.egg
Searching for py>=1.5.0
Best match: py 1.5.4
Processing py-1.5.4-py2.7.egg

Using /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/.eggs/py-1.5.4-py2.7.egg
Searching for pluggy>=0.7
Best match: pluggy 0.7.1
Processing pluggy-0.7.1-py2.7.egg

Using /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/.eggs/pluggy-0.7.1-py2.7.egg
Searching for pathlib2>=2.2.0
Best match: pathlib2 2.3.2
Processing pathlib2-2.3.2-py2.7.egg

Using /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/.eggs/pathlib2-2.3.2-py2.7.egg
Searching for more-itertools>=4.0.0
Best match: more-itertools 4.3.0
Processing more_itertools-4.3.0-py2.7.egg

Using /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/.eggs/more_itertools-4.3.0-py2.7.egg
Searching for attrs>=17.4.0
Best match: attrs 18.1.0
Processing attrs-18.1.0-py2.7.egg

Using /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/.eggs/attrs-18.1.0-py2.7.egg
Searching for atomicwrites>=1.0
Best match: atomicwrites 1.1.5
Processing atomicwrites-1.1.5-py2.7.egg

Using /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/.eggs/atomicwrites-1.1.5-py2.7.egg
running egg_info
writing requirements to GSLab_Make.egg-info/requires.txt
writing GSLab_Make.egg-info/PKG-INFO
writing top-level names to GSLab_Make.egg-info/top_level.txt
writing dependency_links to GSLab_Make.egg-info/dependency_links.txt
reading manifest file 'GSLab_Make.egg-info/SOURCES.txt'
writing manifest file 'GSLab_Make.egg-info/SOURCES.txt'
running build_ext
============================= test session starts ==============================
platform darwin -- Python 2.7.15, pytest-3.7.1, py-1.5.4, pluggy-0.7.1
rootdir: /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make, inifile:
collected 47 items

gslab_make_dev/tests/test_clear_dir.py ...                               [  6%]
gslab_make_dev/tests/test_execute_command.py ...                         [ 12%]
gslab_make_dev/tests/test_remove_path.py FFF.                            [ 21%]
gslab_make_dev/tests/test_run_perl.py .....F.                            [ 36%]
gslab_make_dev/tests/test_run_python.py ......F..                        [ 55%]
gslab_make_dev/tests/test_run_stata.py F....F.                           [ 70%]
gslab_make_dev/tests/test_tablefill.py ....                              [ 78%]
gslab_make_dev/tests/test_textfill.py ........                           [ 95%]
gslab_make_dev/tests/test_zip.py ..                                      [100%]

=================================== FAILURES ===================================
_________________________ testRemovePath.test_default __________________________

self = <gslab_make_dev.tests.test_remove_path.testRemovePath testMethod=test_default>

    def test_default(self):
        self.assertTrue(os.path.isdir('./output_local/'))
        remove_path('./output_local/')
>       self.assertFalse(os.path.isfile('./output_local/text.txt'))
E       AssertionError: True is not false

gslab_make_dev/tests/test_remove_path.py:26: AssertionError
----------------------------- Captured stdout call -----------------------------
<subprocess.Popen object at 0x10a19d8d0>
rm -rf "/Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/output_local"

Deleted: "/Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/output_local"
______________________ testRemovePath.test_default_noisy _______________________

self = <gslab_make_dev.tests.test_remove_path.testRemovePath testMethod=test_default_noisy>

    def test_default_noisy(self):
        self.assertTrue(os.path.isfile('./output_local/text.txt'))
        with open('stdout.txt', 'w') as f:
                with redirect_stdout(f):
                        remove_path('./output_local/')
>               self.assertIn('Deleted:', open('stdout.txt').read())
E               AssertionError: 'Deleted:' not found in ''

gslab_make_dev/tests/test_remove_path.py:34: AssertionError
_________________________ testRemovePath.test_options __________________________

self = <gslab_make_dev.tests.test_remove_path.testRemovePath testMethod=test_options>

    def test_options(self):
        self.assertTrue(os.path.isfile('./output_local/text.txt'))
        os.makedirs('./output_local/temp_dir/')
        with self.assertRaises(OSError):
>           remove_path('./output_local', option='v')
E           AssertionError: OSError not raised

gslab_make_dev/tests/test_remove_path.py:40: AssertionError
----------------------------- Captured stdout call -----------------------------
<subprocess.Popen object at 0x10a1e30d0>
rm v "/Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/output_local"

Deleted: "/Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/output_local"
--------------------------- Captured stderr teardown ---------------------------
rm: v: No such file or directory
rm: /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/output_local: No such file or directory
________________________ testRunPerl.test_no_extension _________________________

self = <gslab_make_dev.tests.test_run_perl.testRunPerl testMethod=test_no_extension>

    def test_no_extension(self):
        with nostderrout():
>           run_perl(program = 'gslab_make_dev/tests/input/perl_test_script')

gslab_make_dev/tests/test_run_perl.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

kwargs = {'program': 'gslab_make_dev/tests/input/perl_test_script'}
e = CritError()

    def run_perl(**kwargs):
    
        try:
            directive = ProgramDirective(application = 'perl', **kwargs)
    
            # Execute
            command = metadata.commands[directive.osname][directive.application] % (directive.executable, directive.option, directive.program, directive.args)
            directive.execute_command(command)
            directive.write_log()
        except Exception as e:
            print(e)
>           raise Exception
E           Exception

gslab_make_dev/run_program.py:59: Exception
_______________________ testRunPython.test_no_extension ________________________

self = <gslab_make_dev.tests.test_run_python.testRunPython testMethod=test_no_extension>

    def test_no_extension(self):
        with nostderrout():
>           run_python(program = 'gslab_make_dev/tests/input/python_test_script')

gslab_make_dev/tests/test_run_python.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

kwargs = {'program': 'gslab_make_dev/tests/input/python_test_script'}
e = CritError()

    def run_python(**kwargs):
    
        try:
            directive = ProgramDirective(application = 'python', **kwargs)
    
            # Execute
            command = metadata.commands[directive.osname][directive.application] % (directive.executable, directive.option, directive.program, directive.args)
            directive.execute_command(command)
            directive.write_log()
        except Exception as e:
            print(e)
>           raise Exception
E           Exception

gslab_make_dev/run_program.py:73: Exception
_______________________ testRunStata.test_bad_executable _______________________

self = <gslab_make_dev.tests.test_run_stata.testRunStata testMethod=test_bad_executable>

    def test_bad_executable(self):
        with nostderrout():
>           run_stata(program = 'gslab_make_dev/tests/input/stata_test_script.do', executable = 'nonexistent_stata_executable')

gslab_make_dev/tests/test_run_stata.py:53: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

kwargs = {'executable': 'nonexistent_stata_executable', 'program': 'gslab_make_dev/tests/input/stata_test_script.do'}
directive = <gslab_make_dev.private.programdirective.ProgramDirective object at 0x10a143f90>
program_log = '/Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/stata_test_script.log'
command = 'nonexistent_stata_executable -e do /Users/jacob/Documents/School/Stanford/RA/Gentzkow/gslab_make/gslab_make_dev/tests/input/stata_test_script.do'
e = CritError()

    def run_stata(**kwargs):
    
        try:
            directive = ProgramDirective(application = 'stata', **kwargs)
    
            # Get program output
            program_log = os.path.join(os.getcwd(), directive.program_name + '.log')
    
            # Execute
            command = metadata.commands[directive.osname]['stata'] % (directive.executable, directive.option, directive.program)
            directive.execute_command(command)
            directive.write_log()
            directive.move_program_output(program_log, directive.log)
        except Exception as e:
            print(e)
>           raise Exception
E           Exception

gslab_make_dev/run_program.py:28: Exception
________________________ testRunStata.test_no_extension ________________________

self = <gslab_make_dev.tests.test_run_stata.testRunStata testMethod=test_no_extension>

    def test_no_extension(self):
        with nostderrout():
>           run_stata(program = 'gslab_make_dev/tests/input/stata_test_script')

gslab_make_dev/tests/test_run_stata.py:43: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

kwargs = {'program': 'gslab_make_dev/tests/input/stata_test_script'}
e = CritError()

    def run_stata(**kwargs):
    
        try:
            directive = ProgramDirective(application = 'stata', **kwargs)
    
            # Get program output
            program_log = os.path.join(os.getcwd(), directive.program_name + '.log')
    
            # Execute
            command = metadata.commands[directive.osname]['stata'] % (directive.executable, directive.option, directive.program)
            directive.execute_command(command)
            directive.write_log()
            directive.move_program_output(program_log, directive.log)
        except Exception as e:
            print(e)
>           raise Exception
E           Exception

gslab_make_dev/run_program.py:28: Exception
===================== 7 failed, 40 passed in 12.29 seconds =====================
Name                                           Stmts   Miss Branch BrPart  Cover   Missing
------------------------------------------------------------------------------------------
gslab_make_dev/dir_mod.py                         45      2     18      2    94%   37, 43, 34->37, 42->43
gslab_make_dev/make_link_logs.py                  18     11      2      0    35%   18-24, 29-35
gslab_make_dev/make_links.py                      13      5      0      0    62%   18-25
gslab_make_dev/make_logs.py                       82     54     22      0    27%   18-26, 36-37, 49-66, 73-81, 85-95, 99-117
gslab_make_dev/private/exceptionclasses.py        13      0      0      0   100%
gslab_make_dev/private/linkdirective.py          104     76     32      0    21%   20-26, 29-30, 33-41, 44-52, 59-69, 72-79, 82-86, 89-94, 97-99, 102-109, 118-122, 125-128, 131-133, 136-142, 145-149
gslab_make_dev/private/messages.py                20      0      0      0   100%
gslab_make_dev/private/metadata.py                 8      0      0      0   100%
gslab_make_dev/private/programdirective.py       105     13     26      7    83%   32, 56, 97, 122, 140-141, 151-154, 157-160, 31->32, 54->60, 55->56, 96->97, 120->126, 121->122, 127->exit
gslab_make_dev/private/utility.py                 62     43     10      0    26%   16-30, 34-53, 66-79, 83-88
gslab_make_dev/refactor_tests.py                  19     19      0      0     0%   2-36
gslab_make_dev/run_program.py                    118     72     14      0    35%   33-45, 78-87, 92-101, 106-144, 149-158, 163-177
gslab_make_dev/tablefill.py                      141      5     68     10    93%   53, 105, 138, 171, 174, 32->35, 35->37, 52->53, 83->exit, 91->88, 104->105, 122->119, 137->138, 167->171, 173->174
gslab_make_dev/tablefill_info.py                   0      0      0      0   100%
gslab_make_dev/tests/nostderrout.py               12      0      2      0   100%
gslab_make_dev/tests/test_clear_dir.py            41      2      8      1    94%   55-56, 54->55
gslab_make_dev/tests/test_delete_files.py          0      0      0      0   100%
gslab_make_dev/tests/test_execute_command.py      84      8     16      7    83%   17-20, 31, 52, 72, 98-99, 15->17, 28->31, 49->52, 69->72, 92->94, 94->exit, 97->98
gslab_make_dev/tests/test_remove_path.py          49      7      6      2    84%   27, 41-44, 61-62, 55->57, 60->61
gslab_make_dev/tests/test_run_lyx.py               0      0      0      0   100%
gslab_make_dev/tests/test_run_mathematica.py       0      0      0      0   100%
gslab_make_dev/tests/test_run_matlab.py            0      0      0      0   100%
gslab_make_dev/tests/test_run_perl.py             64      5     10      4    88%   47-48, 74, 77-78, 67->69, 69->71, 73->74, 76->77
gslab_make_dev/tests/test_run_python.py           74      5     10      4    89%   47-48, 86, 89-90, 79->81, 81->83, 85->86, 88->89
gslab_make_dev/tests/test_run_r.py                 0      0      0      0   100%
gslab_make_dev/tests/test_run_stata.py            59      6     10      5    84%   44, 54, 67, 69, 72-73, 62->64, 64->66, 66->67, 68->69, 71->72
gslab_make_dev/tests/test_tablefill.py            96      2     42      6    94%   143-144, 20->exit, 37->34, 57->43, 74->exit, 138->exit, 142->143
gslab_make_dev/tests/test_textfill.py             83      2     12      3    95%   138-139, 17->exit, 133->exit, 137->138
gslab_make_dev/tests/test_zip.py                  36      2      4      2    90%   46-47, 42->exit, 45->46
gslab_make_dev/textfill.py                       135      2     60      5    96%   44, 170, 32->35, 35->37, 43->44, 100->exit, 169->170
gslab_make_dev/textfill_info.py                    0      0      0      0   100%
------------------------------------------------------------------------------------------
TOTAL                                           1481    341    372     58    74%
